var Utilities,autoScroll,IView;(function(n,t){typeof exports=="object"&&typeof module!="undefined"?t():typeof define=="function"&&define.amd?define(t):t()})(this,function(){"use strict";function f(n){var t=this.constructor;return this.then(function(i){return t.resolve(n()).then(function(){return i})},function(i){return t.resolve(n()).then(function(){return t.reject(i)})})}function h(){}function c(n,t){return function(){n.apply(t,arguments)}}function n(t){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if(typeof t!="function")throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=undefined;this._deferreds=[];o(t,this)}function e(i,u){while(i._state===3)i=i._value;if(i._state===0){i._deferreds.push(u);return}i._handled=!0;n._immediateFn(function(){var n=i._state===1?u.onFulfilled:u.onRejected,f;if(n===null){(i._state===1?r:t)(u.promise,i._value);return}try{f=n(i._value)}catch(e){t(u.promise,e);return}r(u.promise,f)})}function r(i,r){try{if(r===i)throw new TypeError("A promise cannot be resolved with itself.");if(r&&(typeof r=="object"||typeof r=="function")){var f=r.then;if(r instanceof n){i._state=3;i._value=r;u(i);return}if(typeof f=="function"){o(c(f,r),i);return}}i._state=1;i._value=r;u(i)}catch(e){t(i,e)}}function t(n,t){n._state=2;n._value=t;u(n)}function u(t){t._state===2&&t._deferreds.length===0&&n._immediateFn(function(){t._handled||n._unhandledRejectionFn(t._value)});for(var i=0,r=t._deferreds.length;i<r;i++)e(t,t._deferreds[i]);t._deferreds=null}function l(n,t,i){this.onFulfilled=typeof n=="function"?n:null;this.onRejected=typeof t=="function"?t:null;this.promise=i}function o(n,i){var u=!1;try{n(function(n){u||(u=!0,r(i,n))},function(n){u||(u=!0,t(i,n))})}catch(f){if(u)return;u=!0;t(i,f)}}var s=setTimeout,i;n.prototype["catch"]=function(n){return this.then(null,n)};n.prototype.then=function(n,t){var i=new this.constructor(h);return e(this,new l(n,t,i)),i};n.prototype["finally"]=f;n.all=function(t){return new n(function(n,i){function e(t,u){try{if(u&&(typeof u=="object"||typeof u=="function")){var o=u.then;if(typeof o=="function"){o.call(u,function(n){e(t,n)},i);return}}r[t]=u;--f==0&&n(r)}catch(s){i(s)}}var r,f,u;if(!t||typeof t.length=="undefined")throw new TypeError("Promise.all accepts an array");if(r=Array.prototype.slice.call(t),r.length===0)return n([]);for(f=r.length,u=0;u<r.length;u++)e(u,r[u])})};n.resolve=function(t){return t&&typeof t=="object"&&t.constructor===n?t:new n(function(n){n(t)})};n.reject=function(t){return new n(function(n,i){i(t)})};n.race=function(t){return new n(function(n,i){for(var r=0,u=t.length;r<u;r++)t[r].then(n,i)})};n._immediateFn=typeof setImmediate=="function"&&function(n){setImmediate(n)}||function(n){s(n,0)};n._unhandledRejectionFn=function(n){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};i=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object");}();"Promise"in i?i.Promise.prototype["finally"]||(i.Promise.prototype["finally"]=f):i.Promise=n}),function(n){"use strict";function f(n){if(typeof n!="string"&&(n=String(n)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(n))throw new TypeError("Invalid character in header field name");return n.toLowerCase()}function s(n){return typeof n!="string"&&(n=String(n)),n}function e(n){var t={next:function(){var t=n.shift();return{done:t===undefined,value:t}}};return i.iterable&&(t[Symbol.iterator]=function(){return t}),t}function t(n){this.map={};n instanceof t?n.forEach(function(n,t){this.append(t,n)},this):Array.isArray(n)?n.forEach(function(n){this.append(n[0],n[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(t){this.append(t,n[t])},this)}function o(n){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}function h(n){return new Promise(function(t,i){n.onload=function(){t(n.result)};n.onerror=function(){i(n.error)}})}function b(n){var t=new FileReader,i=h(t);return t.readAsArrayBuffer(n),i}function k(n){var t=new FileReader,i=h(t);return t.readAsText(n),i}function d(n){for(var i=new Uint8Array(n),r=new Array(i.length),t=0;t<i.length;t++)r[t]=String.fromCharCode(i[t]);return r.join("")}function c(n){if(n.slice)return n.slice(0);var t=new Uint8Array(n.byteLength);return t.set(new Uint8Array(n)),t.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(n){if(this._bodyInit=n,n)if(typeof n=="string")this._bodyText=n;else if(i.blob&&Blob.prototype.isPrototypeOf(n))this._bodyBlob=n;else if(i.formData&&FormData.prototype.isPrototypeOf(n))this._bodyFormData=n;else if(i.searchParams&&URLSearchParams.prototype.isPrototypeOf(n))this._bodyText=n.toString();else if(i.arrayBuffer&&i.blob&&p(n))this._bodyArrayBuffer=c(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else if(i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(n)||w(n)))this._bodyArrayBuffer=c(n);else throw new Error("unsupported BodyInit type");else this._bodyText="";this.headers.get("content-type")||(typeof n=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var n=o(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}),this.text=function(){var n=o(this);if(n)return n;if(this._bodyBlob)return k(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(d(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");else return Promise.resolve(this._bodyText)},i.formData&&(this.formData=function(){return this.text().then(nt)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(n){var t=n.toUpperCase();return a.indexOf(t)>-1?t:n}function u(n,i){i=i||{};var r=i.body;if(n instanceof u){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url;this.credentials=n.credentials;i.headers||(this.headers=new t(n.headers));this.method=n.method;this.mode=n.mode;r||n._bodyInit==null||(r=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=i.credentials||this.credentials||"omit",(i.headers||!this.headers)&&(this.headers=new t(i.headers)),this.method=g(i.method||this.method||"GET"),this.mode=i.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function nt(n){var t=new FormData;return n.trim().split("&").forEach(function(n){if(n){var i=n.split("="),r=i.shift().replace(/\+/g," "),u=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(u))}}),t}function tt(n){var i=new t,r=n.replace(/\r?\n[\t ]+/g," ");return r.split(/\r?\n/).forEach(function(n){var t=n.split(":"),r=t.shift().trim(),u;r&&(u=t.join(":").trim(),i.append(r,u))}),i}function r(n,i){i||(i={});this.type="default";this.status=i.status===undefined?200:i.status;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in i?i.statusText:"OK";this.headers=new t(i.headers);this.url=i.url||"";this._initBody(n)}var i,a,v;if(!n.fetch){if(i={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(n){return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n},i.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=function(n){return n&&DataView.prototype.isPrototypeOf(n)},w=ArrayBuffer.isView||function(n){return n&&y.indexOf(Object.prototype.toString.call(n))>-1};t.prototype.append=function(n,t){n=f(n);t=s(t);var i=this.map[n];this.map[n]=i?i+","+t:t};t.prototype["delete"]=function(n){delete this.map[f(n)]};t.prototype.get=function(n){return n=f(n),this.has(n)?this.map[n]:null};t.prototype.has=function(n){return this.map.hasOwnProperty(f(n))};t.prototype.set=function(n,t){this.map[f(n)]=s(t)};t.prototype.forEach=function(n,t){for(var i in this.map)this.map.hasOwnProperty(i)&&n.call(t,this.map[i],i,this)};t.prototype.keys=function(){var n=[];return this.forEach(function(t,i){n.push(i)}),e(n)};t.prototype.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),e(n)};t.prototype.entries=function(){var n=[];return this.forEach(function(t,i){n.push([i,t])}),e(n)};i.iterable&&(t.prototype[Symbol.iterator]=t.prototype.entries);a=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];u.prototype.clone=function(){return new u(this,{body:this._bodyInit})};l.call(u.prototype);l.call(r.prototype);r.prototype.clone=function(){return new r(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new t(this.headers),url:this.url})};r.error=function(){var n=new r(null,{status:0,statusText:""});return n.type="error",n};v=[301,302,303,307,308];r.redirect=function(n,t){if(v.indexOf(t)===-1)throw new RangeError("Invalid status code");return new r(null,{status:t,headers:{location:n}})};n.Headers=t;n.Request=u;n.Response=r;n.fetch=function(n,t){return new Promise(function(f,e){var s=new u(n,t),o=new XMLHttpRequest;o.onload=function(){var n={status:o.status,statusText:o.statusText,headers:tt(o.getAllResponseHeaders()||"")},t;n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL");t="response"in o?o.response:o.responseText;f(new r(t,n))};o.onerror=function(){e(new TypeError("Network request failed"))};o.ontimeout=function(){e(new TypeError("Network request failed"))};o.open(s.method,s.url,!0);s.credentials==="include"?o.withCredentials=!0:s.credentials==="omit"&&(o.withCredentials=!1);"responseType"in o&&i.blob&&(o.responseType="blob");s.headers.forEach(function(n,t){o.setRequestHeader(t,n)});o.send(typeof s._bodyInit=="undefined"?null:s._bodyInit)})};n.fetch.polyfill=!0}}(typeof self!="undefined"?self:this),function(n){function t(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("hide");n.classList.remove("show");n.classList.remove("show-inline");n.classList.remove("show-flex")}function i(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show");n.classList.remove("hide");n.classList.remove("show-inline");n.classList.remove("show-flex")}function l(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show-inline");n.classList.remove("hide");n.classList.remove("show");n.classList.remove("show-flex")}function a(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show-inline-flex");n.classList.remove("hide");n.classList.remove("show");n.classList.remove("show-flex")}function v(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show-flex");n.classList.remove("hide");n.classList.remove("show-inline");n.classList.remove("show")}function e(n,u,f){var e,o,s;typeof n=="string"&&(n=document.getElementById(n));u&&(r(n),e=document.createElement("div"),e.classList.add("notification"),e.classList.add("is-danger"),o=document.createElement("button"),o.classList.add("delete"),o.onclick=function(){t(n)},e.appendChild(o),Array.isArray(u)?(s=document.createElement("ul"),u.forEach(function(n){var t=document.createElement("li");t.appendChild(document.createTextNode(n));s.appendChild(t)}),e.appendChild(s)):e.appendChild(document.createTextNode(u)),n.appendChild(e));i(n);(f==undefined||f===!0)&&window.setTimeout(function(){t(n)},1e4)}function r(n){if(n!==null&&n!==undefined)while(n.firstChild)n.removeChild(n.firstChild)}function y(n,t,i){i===void 0&&(i=!1);var r=document.createElement("option");return r.value=n,r.text=t,r.selected=i,r}function o(n){return typeof n=="string"&&(n=document.getElementById(n)),n.value}function p(n,t){typeof n=="string"&&(n=document.getElementById(n));n.value=t}function u(n,t){typeof n=="string"&&(n=document.getElementById(n));r(n);n.appendChild(document.createTextNode(t))}function s(n){var u=n.replace("nav-",""),r=document.querySelectorAll("#menuTabs > li > a"),t,i;if(r.length>0)for(t=0;t<r.length;t++)i=r.item(t),i.id===n?i.parentElement.classList.add("is-active"):i.parentElement.classList.remove("is-active");f("#views > section",u)}function w(n,t,i){h(n,"nav-"+i);f(t,i)}function h(n,t){var u=document.querySelectorAll(n),i,r;if(u.length>0)for(i=0;i<u.length;i++)r=u.item(i),r.id===t?r.classList.add("is-active"):r.classList.remove("is-active")}function f(n,r){var e=document.querySelectorAll(n),u,f;if(e.length>0)for(u=0;u<e.length;u++)f=e.item(u),f.id===r?i(f):t(f)}function b(n){return fetch(n,{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-cache",credentials:"include"}).then(function(n){if(!n.ok)throw new Error(n.statusText);return n.json()})}function k(n,t){return fetch(n,{method:"POST",body:JSON.stringify(t),cache:"no-cache",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(n){if(!n.ok)throw new Error(n.statusText);return n.json()})}function d(n,t){return fetch(n,{method:"POST",body:t!==null?JSON.stringify(t):"",cache:"no-cache",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(n){return n})}function g(n){return n.toLocaleString("en-US",{style:"currency",currency:"USD"})}function nt(n){return n instanceof Date?n.toLocaleDateString("en-us"):new Date(n).toLocaleDateString("en-US")}function tt(n){return n instanceof Date?n.toLocaleString("en-us"):new Date(n).toLocaleString("en-US")}function it(n,t,i){var r,u;return(typeof n=="string"&&(n=document.getElementById(n)),r=n,r.tagName.toLowerCase()==="select"?r.parentElement.classList.remove("is-danger"):r.classList.remove("is-danger"),u=o(r).trim(),u.length==0)?(r.tagName.toLowerCase()==="select"?r.parentElement.classList.add("is-danger"):r.classList.add("is-danger"),e(t,i),r.focus(),r.scrollTo(),""):u}function rt(n,t){typeof n=="string"&&(n=document.getElementById(n));var i=n;i.disabled=t;i.classList.toggle("is-loading",t)}function ut(n){var u=document.createElement("li"),t,i,f,o,r,e,s;if(n.selected&&u.classList.add("is-active"),t=document.createElement("a"),t.id=n.id,t.onclick=function(){c(n)},n.icon.length>0){for(i=document.createElement("span"),i.classList.add("icon"),i.classList.add("is-medium"),f=document.createElement("i"),o=n.icon.split(" "),r=0,e=o;r<e.length;r++)s=e[r],f.classList.add(s);i.appendChild(f);t.appendChild(i)}return t.appendChild(document.createTextNode(n.label)),u.appendChild(t),u}function c(n){u("menuTitle",n.title);u("menuSubTitle",n.subTitle);s(n.id);document.getElementById(n.autofocusId).focus()}function ft(t,i){for(var f,e=document.getElementById(t),r=0,u=i;r<u.length;r++)f=u[r],e.appendChild(n.Create_Menu_Element(f))}function et(){return(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))!=-1?"Opera":navigator.userAgent.indexOf("Chrome")!=-1?"Chrome":navigator.userAgent.indexOf("Safari")!=-1?"Safari":navigator.userAgent.indexOf("Firefox")!=-1?"Firefox":navigator.userAgent.indexOf("MSIE")!=-1||!!document.DOCUMENT_NODE==!0?"IE":"unknown"}function ot(n){var t="/",i=window.location.pathname.toLowerCase().indexOf(n);return i==0&&(t=n+"/"),t}n.Hide=t;n.Show=i;n.Show_Inline=l;n.Show_Inline_Flex=a;n.Show_Flex=v;n.Error_Show=e;n.Clear_Element=r;n.Create_Option=y;n.Get_Value=o;n.Set_Value=p;n.Set_Text=u;n.Show_Menu=s;n.Handle_Tabs=w;n.Activate_Inactivate_Selector=h;n.Show_Hide_Selector=f;n.Get=b;n.Post=k;n.Post_Empty=d;n.Format_Amount=g;n.Format_Date=nt;n.Format_DateTime=tt;n.Validate_Text=it;n.Toggle_Loading_Button=rt;n.Create_Menu_Element=ut;n.Update_Menu=c;n.Build_Menu_Elements=ft;n.CheckBrowser=et;n.Get_Path=ot}(Utilities||(Utilities={})),function(n){var t=function(){function t(){this.Assigned_Inspector=""}return t.GetUnits=function(){var t=Utilities.Get_Path("/inspectionview");Utilities.Get(t+"API/Unit/List").then(function(t){n.allUnits=t;n.mapController.UpdateUnitLayer(t)},function(t){console.log("error getting units",t);n.allUnits=[]})},t.UnitView=function(n){var t=document.createElement("ol"),i=document.createElement("li");return i.appendChild(document.createTextNode("Date Last Updated: "+Utilities.Format_DateTime(n.Date_Last_Communicated))),t.appendChild(i),t.outerHTML},t}();n.Unit=t}(IView||(IView={})),function(n){var t=function(){function t(i){this.mapDiv=i;this.isDrawing=!1;var r=this;require(["esri/map","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/GraphicsLayer","esri/dijit/HomeButton","dojo/_base/array","dojo/parser","esri/Color","dijit/layout/BorderContainer","esri/toolbars/draw","dojo/domReady!"],function(u,f,e,o,s,h,c,l,a){var v,y;r.defaultExtent=new esri.geometry.Extent(-82.17868,29.6946,-81.45182,30.21792,new esri.SpatialReference({wkid:4326}));v={basemap:"osm",zoom:11,logo:!1,extent:r.defaultExtent};r.map=new u(i,v);r.map.on("load",function(t){r.drawToolbar=new a(t.map,{showTooltips:!1});r.drawToolbar.on("DrawEnd",n.FindItemsInExtent);console.log("map loaded");n.mapLoadCompleted()});y=new o({map:r.map,extent:r.defaultExtent},"HomeButton");y.startup();n.location_layer=new e;n.location_layer.id="locations";n.location_layer.on("click",function(i){i!==undefined&&i.graphic&&i.graphic.attributes&&(n.last_symbol_color=i.graphic.symbol.color,n.last_selected_graphic=i.graphic,i.graphic.symbol.color=new c([255,0,0,1]),n.location_layer.redraw(),t.GetLocation(i.graphic.attributes.LookupKey))});n.location_layer.show();n.unit_layer=new e;n.unit_layer.id="units";n.order_layer===undefined&&(n.order_layer=new e,n.order_layer.id="myLocations",n.order_layer.hide());n.order_layer.on("click",function(i){i!==undefined&&i.graphic&&i.graphic.attributes&&(n.last_symbol_color=null,n.last_selected_graphic=null,t.GetLocation(i.graphic.attributes.LookupKey))});r.map.addLayers([n.location_layer,n.unit_layer,n.order_layer])})}return t.GetLocation=function(t){var i=n.filteredLocations.filter(function(n){return n.lookup_key===t});i.length!==0&&(n.current_location=i[0],console.log("location found",i[0]),n.mapController.CenterOnPoint(i[0].point_to_use),i[0].LocationView())},t.prototype.ToggleDraw=function(n){n===void 0&&(n=null);var t=this;require(["esri/toolbars/draw"],function(i){t.isDrawing=n!==null?n:!t.isDrawing;t.isDrawing?t.drawToolbar.activate(i.EXTENT):t.drawToolbar.deactivate()})},t.prototype.ToggleMyLocations=function(t){var i=this.map,r=this.defaultExtent;t?(Utilities.Hide(document.getElementById("Legend")),n.order_layer.show(),n.location_layer.hide()):(Utilities.Show(document.getElementById("Legend")),n.order_layer.hide(),n.location_layer.show())},t.prototype.UpdateUnitLayer=function(t){require(["esri/layers/GraphicsLayer","esri/geometry/Point","esri/symbols/SimpleMarkerSymbol","esri/symbols/PictureMarkerSymbol","esri/graphic","esri/SpatialReference","esri/Color","esri/InfoTemplate","esri/geometry/webMercatorUtils","esri/symbols/TextSymbol"],function(i,r,u,f,e,o,s,h,c,l){var d,g,w,v,nt,b,a,y,tt,p,k,it;for(n.unit_layer.clear(),d=function(t){g=new r([t.Longitude,t.Latitude],new o({wkid:4326}));w=c.geographicToWebMercator(g);v=new h;v.setTitle("Vehicle: "+t.Name);v.setContent(function(){var i=n.Unit.UnitView(t);return console.log("html info template",i),i});nt=new f({angle:0,xoffset:0,yoffset:0,type:"esriPMS",url:t.Unit_Icon_URL,contentType:"image/png",width:30,height:30});b=new e(w,nt);b.setInfoTemplate(v);n.unit_layer.add(b);a=new l(t.Assigned_Inspector.length>0?t.Assigned_Inspector:t.Name);a.setColor(new dojo.Color([0,100,0]));a.setOffset(0,-20);a.setAlign(l.ALIGN_MIDDLE);y=new esri.symbol.Font;y.setSize("10pt");y.setWeight(esri.symbol.Font.WEIGHT_BOLD);a.setFont(y);tt=new e(w,a);n.unit_layer.add(tt)},p=0,k=t;p<k.length;p++)it=k[p],d(it);n.unit_layer.show()})},t.prototype.UpdateLocationLayer=function(t){require(["esri/layers/GraphicsLayer","esri/geometry/Point","esri/symbols/SimpleMarkerSymbol","esri/graphic","esri/SpatialReference","esri/Color","esri/InfoTemplate","esri/geometry/webMercatorUtils","esri/symbols/TextSymbol"],function(i,r,u,f,e,o,s,h,c){var v,w,y,b,a,p,g;for(n.location_layer.clear(),v=0,w=t;v<w.length;v++){var l=w[v],k=l.point_to_use,nt=new r([k.Longitude,k.Latitude],new e({wkid:4326})),d=h.geographicToWebMercator(nt);for(y=0;y<l.icons.length;y++)b=new f(d,l.icons[y]),b.setAttributes({LookupKey:l.lookup_key}),n.location_layer.add(b);l.inspections.length>1&&(a=new c(l.inspections.length.toString()),a.setColor(new dojo.Color([0,100,0])),a.setOffset(0,-20),a.setAlign(c.ALIGN_MIDDLE),p=new esri.symbol.Font,p.setSize("10pt"),p.setWeight(esri.symbol.Font.WEIGHT_BOLD),a.setFont(p),g=new f(d,a),n.location_layer.add(g))}})},t.prototype.UpdateMyLocationLayer=function(t){require(["esri/layers/GraphicsLayer","esri/geometry/Point","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/graphic","esri/SpatialReference","esri/Color","esri/geometry/webMercatorUtils","esri/geometry/Polyline"],function(i,r,u,f,e,o,s,h,c){var a,w,v,y,d,g,b,l,p,k,nt;for(t.sort(function(n,t){return t.order-n.order}),n.order_layer===undefined&&(n.order_layer=new i,n.order_layer.id="myLocations",n.order_layer.hide()),a=n.order_layer,a.clear(),w=[],v=0;v<t.length;v++)y=[],y.push(t[v].point_to_use.Longitude),y.push(t[v].point_to_use.Latitude),w.push(y);var tt={paths:[w],spatialReference:{wkid:4326}},it=new c(tt),rt=new f(f.STYLE_SOLID,new dojo.Color([0,0,0],255),3),ut=new e(it,rt,null,null);for(a.add(ut),d=function(n){var t=n.point_to_use,i;g=new r([t.Longitude,t.Latitude],new o({wkid:4326}));b=h.geographicToWebMercator(g);i=new u({color:s.fromHex(n.unordered?"#FFDD57":"#FFFFFF"),size:26,angle:0,xoffset:0,yoffset:6.5,type:"esriSMS",style:"esriSMSCircle",outline:{color:[0,0,0,255],width:1,type:"esriSLS",style:"esriSLSSolid"}});l=new e(b,i);l.setAttributes({LookupKey:n.lookup_key});a.add(l);n.GetSortedIcon().then(function(t){l=new e(b,t);l.setAttributes({LookupKey:n.lookup_key});a.add(l)})},p=0,k=t;p<k.length;p++)nt=k[p],d(nt)})},t.prototype.FindItemsInExtent=function(t){var r=this,u=this.map,i=[];return require(["esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/Color"],function(r){for(var u,f,e=0,o=n.location_layer.graphics;e<o.length;e++)u=o[e],t.contains(u.geometry)&&u.attributes&&u.attributes.LookupKey&&(f=new r,f.color=u.symbol.color,f.size=u.symbol.size,f.style=r.STYLE_CROSS,f.outline=u.symbol.outline,u.setSymbol(f),i.indexOf(u.attributes.LookupKey)===-1&&i.push(u.attributes.LookupKey))}),r.isDrawing=!1,r.drawToolbar.deactivate(),i},t.prototype.CenterAndZoom=function(n){var t=this.map;require(["esri/geometry/Point"],function(i){var r=new i([n.Longitude,n.Latitude]);t.centerAndZoom(r,18)})},t.prototype.CenterOnPoint=function(n){var t=this.map;require(["esri/geometry/Point"],function(i){var r=new i([n.Longitude,n.Latitude]);t.centerAt(r)})},t.prototype.GetCurrentZoom=function(){var n=document.getElementById("map"),t=n.getAttribute("data-zoom");return parseInt(t)},t}();n.MapController=t}(IView||(IView={})),function(n){var t=function(){function t(t,i){var u,r,f,e;if(i===void 0&&(i=!1),this.lookup_key="",this.point_to_use=null,this.icons=[],this.valid_inspectors=[],this.inspections=[],this.all_inspections=[],this.has_commercial=!1,this.has_residential=!1,this.has_private_provider=!1,this.can_be_bulk_assigned=!0,this.assigned_inspectors=[],this.RBL=!1,this.CBL=!1,this.REL=!1,this.CEL=!1,this.RME=!1,this.CME=!1,this.RPL=!1,this.CPL=!1,this.Fire=!1,this.order=0,this.unordered=!0,this.inspections=t,t.length!==0)if(u=t[0],this.lookup_key=u.LookupKey,this.point_to_use=u.PointToUse,i){for(this.location_distance=new n.LocationDistance(this.point_to_use),this.order=0,r=0,f=t;r<f.length;r++)e=f[r],e.Sort_Order>this.order&&(this.order=e.Sort_Order);this.unordered=this.order===0;this.unordered&&(this.order=999)}else this.UpdateFlags(),this.CreateIcons(),this.AddValidInspectors(n.allInspectors)}return t.prototype.CreateSortedIcon=function(){var n=new dojo.Deferred,t=this;return require(["esri/symbols/TextSymbol","esri/Color","esri/symbols/Font"],function(i,r,u){var f=new i(t.order.toString()),e;f.setColor(new r([0,0,0]));f.rotated=!1;f.setOffset(0,0);f.setAlign(i.ALIGN_MIDDLE);e=new u;e.setSize("20pt");e.setWeight(esri.symbol.Font.WEIGHT_BOLD);f.setFont(e);n.resolve(f)}),n.then(function(n){return n})},t.prototype.GetSortedIcon=function(){return this.CreateSortedIcon()},t.prototype.UpdateFlags=function(){var i,r,t;for(this.assigned_inspectors=[],i=0,r=this.inspections;i<r.length;i++)t=r[i],n.contractor_check?(this.can_be_bulk_assigned=!1,t.CanBeAssigned=!1):t.CanBeAssigned||(this.can_be_bulk_assigned=!1),t.IsCommercial?this.has_commercial=!0:this.has_residential=!0,t.IsPrivateProvider&&(this.has_private_provider=!0),this.assigned_inspectors.indexOf(t.InspectorName)===-1&&(this.assigned_inspectors.push(t.InspectorName),this[t.InspectorName]={commercial:0,residential:0,hexcolor:t.Color}),t.IsCommercial?this[t.InspectorName].commercial+=1:this[t.InspectorName].residential+=1,t.RBL&&(this.RBL=!0),t.CBL&&(this.CBL=!0),t.REL&&(this.REL=!0),t.CEL&&(this.CEL=!0),t.RME&&(this.RME=!0),t.CME&&(this.CME=!0),t.RPL&&(this.RPL=!0),t.CPL&&(this.CPL=!0),t.Fire&&(this.Fire=!0)},t.prototype.AddValidInspectors=function(n){if(this.can_be_bulk_assigned){var t=this;this.valid_inspectors=n.filter(function(n){return(t.RBL===n.RBL==!0||!t.RBL)&&(t.CBL===n.CBL==!0||!t.CBL)&&(t.REL===n.REL==!0||!t.REL)&&(t.CEL===n.CEL==!0||!t.CEL)&&(t.RME===n.RME==!0||!t.RME)&&(t.CME===n.CME==!0||!t.CME)&&(t.RPL===n.RPL==!0||!t.RPL)&&(t.CPL===n.CPL==!0||!t.CPL)&&(t.Fire===n.Fire==!0||!t.Fire)});this.valid_inspectors.length===0&&(this.can_be_bulk_assigned=!1)}},t.prototype.CreateIcons=function(){var i=0,f=this.GetOffsets(),e,n,t,r,o,u;for(this.assigned_inspectors.length>1&&(i=1),e=function(t){var r,u,e;if(i>f.length)return{value:void 0};r="";r=n[t].commercial>0&&n[t].residential>0?"esriSMSDiamond":n[t].commercial>0?"esriSMSSquare":"esriSMSCircle";u=n.CreateIcon(r,n[t].hexcolor,f[i++]);e=n;u.then(function(n){e.icons.push(n)})},n=this,t=0,r=this.assigned_inspectors;t<r.length;t++)if(o=r[t],u=e(o),typeof u=="object")return u.value},t.prototype.CreateIcon=function(n,t,i,r){r===void 0&&(r=12);var u=new dojo.Deferred;return require(["esri/symbols/SimpleMarkerSymbol","esri/Color"],function(f,e){var o=new f({color:e.fromHex(t),size:r,angle:0,xoffset:i[0],yoffset:i[1],type:"esriSMS",style:n,outline:{color:[0,0,0,255],width:1,type:"esriSLS",style:"esriSLSSolid"}});u.resolve(o)}),u},t.prototype.GetOffsets=function(){return[[0,0],[-4,0],[4,0],[0,-4],[0,4],[-4,4],[4,-4],[-4,-4],[4,4]]},t.CreateLocations=function(i){var l=i.length.toString(),r,u,e,o,h,f,s,c;for(Utilities.Set_Text(document.getElementById("inspectionCount"),l),r=[],n.filteredLocations=[],u=0,e=i;u<e.length;u++)o=e[u],r.indexOf(o.LookupKey)===-1&&r.push(o.LookupKey);for(h=function(r){var u=i.filter(function(n){return n.LookupKey===r});n.filteredLocations.push(new t(u))},f=0,s=r;f<s.length;f++)c=s[f],h(c);n.dataLoaded=!0;n.BuildAndLoadInitialLayers()},t.CreateMyLocations=function(n){var u,r,f,o,h,e,s,c,l,i;if(n.length!==0){if(u=[],r=[],n.length===0)return[];for(f=0,o=n;f<o.length;f++)i=o[f],u.indexOf(i.LookupKey)===-1&&u.push(i.LookupKey);for(h=function(i){var u=n.filter(function(n){return n.LookupKey===i});r.push(new t(u,!0))},e=0,s=u;e<s.length;e++)c=s[e],h(c);for(r.sort(function(n,t){return n.order-t.order}),l=0,i=0;i<r.length;i++)r[i].unordered||(r[i].order=++l);return r}},t.prototype.LocationView=function(){var r=document.getElementById("locationAddress"),t,i;Utilities.Clear_Element(r);Utilities.Set_Text(r,this.Address());t=document.getElementById("bulkAssignInspectionsContainer");this.can_be_bulk_assigned&&!n.contractor_check?(Utilities.Show(t),this.UpdateBulkAssignmentDropdown()):Utilities.Hide(t);i=document.getElementById("locationInfoContainer");Utilities.Clear_Element(i);i.appendChild(this.CreateInspectionTable());document.getElementById("locationInfo").classList.add("is-active")},t.prototype.Address=function(){var n=this.inspections[0];return n.StreetAddressCombined+", "+n.City+", "+n.Zip},t.prototype.CreateInspectionTable=function(){var i=document.createElement("table"),t,u,f,e,n,r;for(i.classList.add("table"),i.classList.add("is-fullwidth"),i.appendChild(this.CreateInspectionTableHeading()),t=document.createElement("tbody"),u=null,f=0,e=this.inspections;f<e.length;f++)n=e[f],(u===null||u!==n.MasterPermitNumber)&&(t.appendChild(this.BuildMasterPermitPropUseRow(n)),u=n.MasterPermitNumber),r=null,n.PermitNo.substr(0,1)!=="1"&&(r=document.createElement("tr")),t.appendChild(this.CreateInspectionRow(n,r)),n.PreviousInspectionRemarks.length>0&&t.appendChild(this.CreatePreviouslyFailedInspectionRow(n.PreviousInspectionRemarks)),r!==null&&t.appendChild(r);return i.appendChild(t),i},t.prototype.BuildMasterPermitPropUseRow=function(n){var r=document.createElement("tr"),i;if(n.MasterPermitNumber.length>0){var f="/InspectionScheduler/#permit="+n.MasterPermitNumber,u=this.CreateTableCellLink(n.MasterPermitNumber,f,"has-text-left"),t=document.createElement("a");t.classList.add("button");t.classList.add("is-small");t.classList.add("is-success");t.style.marginLeft=".5em";t.style.fontStyle="italic";t.target="_blank";t.rel="noopener";t.appendChild(document.createTextNode("IMS"));t.href=n.MasterPermitIMSLink;u.appendChild(t);r.appendChild(u);i=document.createElement("td");i.colSpan=7;i.classList.add("has-text-left");i.appendChild(document.createTextNode(n.PropUseInfo));r.appendChild(i)}else r.appendChild(document.createElement("td")),i=document.createElement("td"),i.colSpan=7,i.classList.add("has-text-left"),i.appendChild(document.createTextNode("NO MASTER PERMIT")),r.appendChild(i);return r},t.prototype.CreateInspectionTableHeading=function(){var i=document.createElement("thead"),n=document.createElement("tr"),t;return n.appendChild(this.CreateTableCell(!0,"Permit","","15%")),n.appendChild(this.CreateTableCell(!0,"Scheduled","","15%")),n.appendChild(this.CreateTableCell(!0,"Inspection Type","","20%")),t=this.CreateTableCell(!0,""),t.style.width="5%",n.appendChild(t),n.appendChild(this.CreateTableCell(!0,"Kind","","10%")),n.appendChild(this.CreateTableCell(!0,"Private Provider","","10%")),n.appendChild(this.CreateTableCell(!0,"Status","","15%")),n.appendChild(this.CreateTableCell(!0,"Assigned","","15%")),i.appendChild(n),i},t.prototype.CreateTableCell=function(n,t,i,r){i===void 0&&(i="");r===void 0&&(r="");var u=document.createElement(n?"th":"td");return r.length>0&&(u.style.width=r),i.length>0&&u.classList.add(i),u.appendChild(document.createTextNode(t)),u},t.prototype.CreateTableCellLink=function(n,t,i){var u,r;return i===void 0&&(i=""),u=document.createElement("td"),i.length>0&&u.classList.add(i),r=document.createElement("a"),r.target="_blank",r.rel="noopener",r.href=t,r.appendChild(document.createTextNode(n)),u.appendChild(r),u},t.prototype.CreateInspectionRow=function(t,i){var r=document.createElement("tr"),h="/InspectionScheduler/#permit="+t.PermitNo+"&inspectionid="+t.InspReqID,s=this.CreateTableCellLink(t.PermitNo,h,"has-text-right"),u=document.createElement("a"),e,f,o;return u.classList.add("button"),u.classList.add("is-small"),u.classList.add("is-success"),u.style.marginLeft=".5em",u.style.fontStyle="italic",u.target="_blank",u.rel="noopener",u.appendChild(document.createTextNode("IMS")),u.href=t.IMSLink,s.appendChild(u),r.appendChild(s),r.appendChild(this.CreateTableCell(!1,Utilities.Format_Date(t.ScheduledDate))),r.appendChild(this.CreateTableCell(!1,t.InspectionCode+" "+t.InspectionDescription,"has-text-left")),e=document.createElement("td"),t.PermitNo.substr(0,1)!=="1"&&(f=document.createElement("button"),f.type="button",f.classList.add("button"),f.classList.add("is-info"),f.classList.add("is-small"),f.appendChild(document.createTextNode("Notes")),f.onclick=function(){if(i.childElementCount===0){var r=document.createElement("td");r.colSpan=8;n.Inspection.GetPermitNotes(t.PermitNo,f,r);i.appendChild(r)}else{i.style.display=i.style.display===""?"none":"";return}},e.appendChild(f)),r.appendChild(e),r.appendChild(this.CreateTableCell(!1,t.IsCommercial?"Commercial":"Residential")),r.appendChild(this.CreateTableCell(!1,t.IsPrivateProvider?"Yes":"No")),r.appendChild(this.CreateTableCell(!1,t.IsCompleted?"Completed":"Incomplete")),t.IsCompleted||n.contractor_check?r.appendChild(this.CreateTableCell(!1,t.InspectorName)):(o=document.createElement("td"),o.appendChild(this.CreateInspectorDropdown(t)),r.appendChild(o)),r},t.prototype.CreatePreviouslyFailedInspectionRow=function(n){var t=document.createElement("tr"),u=document.createElement("td"),i,r;return u.appendChild(document.createTextNode("")),t.appendChild(u),i=document.createElement("td"),i.appendChild(document.createTextNode("Failed Last Inspection")),i.colSpan=2,t.appendChild(i),r=document.createElement("td"),r.appendChild(document.createTextNode(n)),r.colSpan=5,t.appendChild(r),t},t.prototype.CreateInspectorDropdown=function(t){var o=document.createElement("div"),r,u,f,s,e,i;for(o.classList.add("control"),r=document.createElement("div"),r.classList.add("select"),u=document.createElement("select"),f=0,s=t.ValidInspectors;f<s.length;f++)e=s[f],i=document.createElement("option"),i.value=e.Name,i.selected=e.Name===t.InspectorName,i.appendChild(document.createTextNode(e.Name)),u.appendChild(i);return u.onchange=function(i){var r=n.allInspectors.filter(function(n){return n.Name===Utilities.Get_Value(i.srcElement)}),e=i.srcElement.parentElement,u,f;r.length===1&&(u=r[0].Id,f=[t.InspReqID],n.Inspection.BulkAssign(u,f,e))},r.appendChild(u),o.appendChild(r),o},t.prototype.UpdateBulkAssignmentDropdown=function(){var r=document.getElementById("bulkAssignInspections"),n,i,u,f,t;for(Utilities.Clear_Element(r),n=document.createElement("option"),n.value="",n.selected=!0,n.appendChild(document.createTextNode("Select Inspector")),r.appendChild(n),i=0,u=this.valid_inspectors;i<u.length;i++)f=u[i],t=document.createElement("option"),t.value=f.Name,t.selected=!1,t.appendChild(document.createTextNode(f.Name)),r.appendChild(t)},t.HandleMyLocations=function(i){var r,e,o,f,u;if(i.length===0){n.myLocations=[];t.UpdateMyLocations();return}if(r=t.CreateMyLocations(i),e=r.filter(function(n){return n.unordered===!1}),n.myLocations.length===0&&e.length===0){for(r=t.UpdateLocationDistances(r,!0),o=0,f=[],u=0;u<r.length;u++)r[u].location_distance.furthest_location_distance>o&&(f=[],o=r[u].location_distance.furthest_location_distance,f.push(r[u].location_distance.furthest_location),f.push(r[u].lookup_key));n.myLocations=t.SortByProximity(r,f[0])}else r=t.UpdateLocationDistances(r,!1),n.myLocations.length===0&&e.length>0?(n.myLocations=r,t.HandleUnorderedLocations()):(t.RemoveMissingFromCurrent(r),t.AddNewLocations(r));t.UpdateMyLocations()},t.UpdateLocationDistances=function(n,t){for(var r,i=0;i<n.length;i++)for(t&&(n[i].unordered=!1),r=0;r<n.length;r++)i!==r&&n[i].location_distance.calculate_distance(n[r].point_to_use,n[r].lookup_key);return n},t.UpdateMyLocations=function(){n.myLocations.sort(function(n,t){return n.order-t.order});t.PopulateMyLocations(n.myLocations);n.mapController.UpdateMyLocationLayer(n.myLocations)},t.RemoveMissingFromCurrent=function(i){for(var e,o,r,s,v,u,h,y,c,l=[],f=0,a=n.myLocations;f<a.length;f++){for(e=a[f],o=!1,r=0,s=i;r<s.length;r++)v=s[r],v.lookup_key===e.lookup_key&&(o=!0);o||l.push(e.lookup_key)}for(u=0,h=l;u<h.length;u++)y=h[u],c=t.GetLocationIndex(y,n.myLocations),c!==-1&&n.myLocations.splice(c,1)},t.GetLocationIndex=function(n,t){for(var i=0;i<t.length;i++)if(t[i].lookup_key===n)return i;return-1},t.AddNewLocations=function(i){for(var r,o,u,s,v,f,h,c,l=!1,e=0,a=i;e<a.length;e++){for(r=a[e],o=!1,u=0,s=n.myLocations;u<s.length;u++)v=s[u],r.lookup_key===v.lookup_key&&(o=!0);o||(r.unordered=!0,n.myLocations.push(r),r.order=999,l=!0)}if(l){for(f=0,h=n.myLocations;f<h.length;f++)c=h[f],c.unordered&&(c.order=999);n.myLocations.sort(function(n,t){return n.order-t.order});n.myLocations=t.UpdateLocationDistances(n.myLocations,!1);t.HandleUnorderedLocations()}},t.HandleUnorderedLocations=function(){for(var i,e,r,o,u,t=0,f=n.myLocations;t<f.length;t++)if(i=f[t],i.unordered){for(e=i.location_distance.GetBestOrderToInsert(n.myLocations),r=0,o=n.myLocations;r<o.length;r++)u=o[r],u.order>=e&&u.order<998&&u.order++;i.order=e}},t.PopulateMyLocations=function(n){var u=document.getElementById("sortableInspections"),i,r,f,e;if(Utilities.Clear_Element(u),n.length===0)i=document.createElement("li"),i.appendChild(document.createTextNode("No incomplete inspections were found.")),i.style.padding="1em 1em 1em 1em",u.appendChild(i);else for(r=0,f=n;r<f.length;r++)e=f[r],u.appendChild(t.CreateMyLocationRow(e))},t.CreateMyLocationRow=function(t){var i=document.createElement("li"),r,o,u,f,e;return i.id=t.lookup_key,i.classList.add("columns"),i.style.borderTop="none",i.style.borderBottom="none",i.style.margin="0 auto",i.style.marginBottom=".25em",t.unordered?i.classList.add("has-background-warning"):i.classList.add("has-background-grey-lighter"),r=document.createElement("span"),r.classList.add("column"),r.classList.add("is-1"),r.classList.add("has-text-centered"),r.style.fontWeight="bolder",r.appendChild(document.createTextNode(t.order.toString())),i.appendChild(r),o=document.createElement("span"),o.classList.add("column"),o.classList.add("is-8"),o.appendChild(document.createTextNode(t.Address())),i.appendChild(o),u=document.createElement("span"),u.classList.add("column"),u.classList.add("is-1"),u.classList.add("has-text-centered"),u.appendChild(document.createTextNode(t.inspections.length.toString())),i.appendChild(u),f=document.createElement("span"),f.classList.add("column"),f.classList.add("is-2"),f.classList.add("has-text-centered"),e=document.createElement("button"),e.classList.add("button"),e.classList.add("is-small"),e.appendChild(document.createTextNode("View")),e.onclick=function(){n.last_selected_graphic=null;n.last_symbol_color=null;n.current_location=t;console.log("location found",t);n.mapController.CenterOnPoint(t.point_to_use);t.LocationView()},f.appendChild(e),i.appendChild(f),i},t.SortByProximity=function(n,i){var r,f,s,e,u;if(i===undefined||i.length===0||n.length<=2)return n;r=[];f=[];f.push(i);s=n[t.GetLocationIndex(i,n)];r.push(s);e=n[t.GetLocationIndex(s.location_distance.closest_location,n)];r.push(e);f.push(e.lookup_key);for(var h=e,o="",c=0,l=0;f.length<n.length||l<50;){if(o=h.location_distance.GetClosestUnused(f),o.length==0)break;if(c=t.GetLocationIndex(o,n),c===-1)break;h=n[c];r.push(h);f.push(o);l++}for(u=0;u<r.length;u++)r[u].order=u+1,r[u].unordered&&(r[u].unordered=!1);return r},t.SaveMyLocations=function(){},t}();n.Location=t}(IView||(IView={})),function(n){var t=function(){function n(n){var i,t,r;for(this.InspectionId=0,i=n.split("&"),t=0;t<i.length;t++){r=i[t].split("=");switch(r[0].toLowerCase()){case"inspectionid":this.InspectionId=parseInt(r[1])}}}return n.prototype.ToHash=function(){var n="";return this.InspectionId>0&&(n+="&inspectionid="+this.InspectionId.toString()),n.length>0&&(n="#"+n.substring(1)),n},n}();n.LocationHash=t}(IView||(IView={})),function(n){var t=function(){function n(n){this.link_location="";this.link_distance=999999;this.closest_location="";this.closest_location_distance=999999;this.next_location="";this.next_location_distance=999999;this.furthest_location="";this.furthest_location_distance=0;this.lookup_keys=[];this.my_point=n}return n.prototype.calculate_distance=function(n,t){if(this[t]!==undefined)return this[t];var i=this;return require(["esri/geometry/Point","esri/SpatialReference","esri/geometry/webMercatorUtils"],function(r,u,f){var o=new r(i.my_point.Longitude,i.my_point.Latitude,new u({wkid:4326})),s=new r(n.Longitude,n.Latitude,new u({wkid:4326})),h=f.geographicToWebMercator(o),c=f.geographicToWebMercator(s),e=esri.geometry.getLength(h,c);return i[t]=e,i.lookup_keys.push(t),i.UpdateLocationDistances(t,e),e})},n.prototype.UpdateLocationDistances=function(n,t){if(t>this.furthest_location_distance&&(this.furthest_location=n,this.furthest_location_distance=t),t<this.closest_location_distance){this.next_location=this.closest_location;this.next_location_distance=this.closest_location_distance;this.closest_location=n;this.closest_location_distance=t;return}t<this.next_location_distance&&(this.next_location=n,this.next_location_distance=t)},n.prototype.GetClosestUnused=function(n){for(var t,r="",u=999999,f=this,i=0,e=this.lookup_keys;i<e.length;i++)t=e[i],n.indexOf(t)===-1&&f[t]<u&&(r=t,u=f[t]);return r},n.prototype.GetBestOrderToInsert=function(n){var f,e,r,t,i,u;for(n.sort(function(n,t){return n.order-t.order}),f=0,e=n;f<e.length;f++)if(r=e[f],r.order<999)for(t=0;t<n.length;t++)n[t].order===r.order+1&&(r.location_distance.link_location=n[t].lookup_key,r.location_distance.link_distance=r.location_distance[n[t].lookup_key]);for(t=0;t<n.length;t++)if(i=n[t],i.order<999&&this[i.lookup_key]<i.location_distance.link_distance){for(u=0;u<n.length;u++)n[u].order===i.order+1&&(this.link_location=n[u].lookup_key,this.link_distance=i.location_distance[n[u].lookup_key]);return i.order+1}return 999},n}();n.LocationDistance=t}(IView||(IView={})),function(n){var t=function(){function t(n,t){this.inspection_id=n;this.inspection_order=t}return t.Save=function(i){var e,r,o,u,f,s,h,c;for(Utilities.Toggle_Loading_Button(i,!0),e=[],r=0,o=n.myLocations;r<o.length;r++)for(u=o[r],u.unordered=!1,f=0,s=u.inspections;f<s.length;f++)h=s[f],e.push(new t(h.InspReqID,u.order));c=Utilities.Get_Path("/inspectionview");Utilities.Post(c+"API/Inspections/Reorder",e).then(function(t){if(t.length===0){alert("There was an error saving the order, your changes might not be saved.");Utilities.Toggle_Loading_Button(i,!1);return}n.Inspection.HandleInspections(t);Utilities.Toggle_Loading_Button(i,!1)},function(n){console.log("error in Reordering Insepctions",n);Utilities.Toggle_Loading_Button(i,!1)})},t}();n.ReorderData=t}(IView||(IView={})),function(n){var t=function(){function t(){this.Id=-1;this.Active=!1;this.Intl="";this.Name="";this.Color="";this.Vehicle="";this.RBL=!1;this.CBL=!1;this.REL=!1;this.CEL=!1;this.RME=!1;this.CME=!1;this.RPL=!1;this.CPL=!1;this.Fire=!1;this.PrivateProvider=!1;this.CurrentCount=0}return t.GetAllInspectors=function(){Utilities.Toggle_Loading_Button("refreshButton",!0);Utilities.Toggle_Loading_Button("myRefreshButton",!0);Utilities.Toggle_Loading_Button("filterButton",!0);var i=Utilities.Get_Path("/inspectionview");Utilities.Get(i+"API/Inspectors/List").then(function(i){var r=n.allInspectors.length===0;console.log("inspectors",i);n.allInspectors=i;n.contractor_check=t.ContractInspectorCheck(i);n.contractor_check?t.HandleContractInspectors():t.BuildBulkAssignDropdown(i);n.Inspection.GetInspections();r&&(t.BuildInspectorList(),n.contractor_check||t.GetInspectorsToEdit(),n.LoadDefaultsFromCookie(),window.setInterval(n.Inspection.GetInspections,3e5),window.setInterval(n.Unit.GetUnits,6e4))},function(){console.log("error getting inspectors");n.allInspectors=[]})},t.ContractInspectorCheck=function(n){var t=n.filter(function(n){return n.contractor===!0});return t.length===n.length},t.HandleContractInspectors=function(){Utilities.Hide("toggleBulkAssign");Utilities.Hide("BulkAssignContainer")},t.GetInspectorsToEdit=function(){var i=Utilities.Get_Path("/inspectionview");Utilities.Get(i+"API/Inspectors/Edit").then(function(i){console.log("inspectors to edit",i);n.inspectors_to_edit=i;i.length>0&&(Utilities.Show_Flex("editInspectors"),t.BuildInspectorControl(i))},function(){console.log("error getting inspectors to edit")})},t.BuildBulkAssignDropdown=function(n){var u=document.getElementById("bulkAssignSelect"),t,i,f,e,r;for(Utilities.Clear_Element(u),t=document.createElement("option"),t.value="-1",t.selected=!0,t.appendChild(document.createTextNode("Select Inspector")),u.appendChild(t),i=0,f=n;i<f.length;i++)e=f[i],r=document.createElement("option"),r.value=e.Id.toString(),r.appendChild(document.createTextNode(e.Name)),u.appendChild(r)},t.BuildInspectorList=function(){var r=document.getElementById("inspectorList"),i,u,f;for(Utilities.Clear_Element(r),r.appendChild(t.AddInspector("All")),i=0,u=n.allInspectors;i<u.length;i++)f=u[i],r.appendChild(t.AddInspector(f.Name));n.FilterInputEvents()},t.AddInspector=function(n){var r=document.createDocumentFragment(),i=document.createElement("label"),t;return i.classList.add("label"),i.classList.add("checkbox"),i.classList.add("is-medium"),t=document.createElement("input"),t.type="checkbox",t.classList.add("checkbox"),t.classList.add("is-medium"),t.name="inspectorFilter",t.value=n,t.checked=n==="All",i.appendChild(t),i.appendChild(document.createTextNode(n)),r.appendChild(i),r},t.BuildInspectorControl=function(n){var f=document.getElementById("inspectorControlList"),i,r,u;for(Utilities.Clear_Element(f),i=0,r=n;i<r.length;i++)u=r[i],u.Id!==0&&f.appendChild(t.BuildInspectorRow(u))},t.AddNewInspector=function(n){var i=document.getElementById("inspectorControlList");n.Id!==0&&i.appendChild(t.BuildInspectorRow(n))},t.BuildInspectorRow=function(n){var r=n.Id.toString(),i=document.createElement("tr");return i.appendChild(t.CreateInputTableCell(r,"name",n.Name)),i.appendChild(t.CreateCheckBoxTableCell(r,"active",n.Active)),i.appendChild(t.CreateTableCell(n.Intl)),i.appendChild(t.CreateTableCell(n.Color)),i.appendChild(t.CreateInputTableCell(r,"vehicle",n.Vehicle)),i.appendChild(t.CreateCheckBoxTableCell(r,"c_b",n.CBL)),i.appendChild(t.CreateCheckBoxTableCell(r,"c_e",n.CEL)),i.appendChild(t.CreateCheckBoxTableCell(r,"c_p",n.CPL)),i.appendChild(t.CreateCheckBoxTableCell(r,"c_m",n.CME)),i.appendChild(t.CreateCheckBoxTableCell(r,"r_b",n.RBL)),i.appendChild(t.CreateCheckBoxTableCell(r,"r_e",n.REL)),i.appendChild(t.CreateCheckBoxTableCell(r,"r_p",n.RPL)),i.appendChild(t.CreateCheckBoxTableCell(r,"r_m",n.RME)),i.appendChild(t.CreateCheckBoxTableCell(r,"fire",n.Fire)),i.appendChild(t.CreateCheckBoxTableCell(r,"private",n.PrivateProvider)),i.appendChild(t.CreateSaveButtonTableCell(r)),i},t.CreateTableCell=function(n){var t=document.createElement("td");return t.appendChild(document.createTextNode(n)),t},t.CreateSaveButtonTableCell=function(n){var u=document.createElement("td"),r=document.createElement("div"),i;return r.classList.add("control"),i=document.createElement("button"),i.classList.add("button"),i.classList.add("is-success"),i.type="button",i.onclick=function(){Utilities.Toggle_Loading_Button(i,!0);var r=new t;r.LoadFromForm(n);r.Update(i)},i.appendChild(document.createTextNode("Save")),r.appendChild(i),u.appendChild(r),u},t.CreateAddButtonTableCell=function(n,i){var f=document.createElement("td"),u=document.createElement("div"),r;return u.classList.add("control"),r=document.createElement("button"),r.classList.add("button"),r.classList.add("is-success"),r.type="button",r.onclick=function(){Utilities.Toggle_Loading_Button(r,!0);var u=new t;(u.LoadFromForm(n,!0),u.ValidateInspector())&&u.Insert(r,i)},r.appendChild(document.createTextNode("Add")),u.appendChild(r),f.appendChild(u),f},t.prototype.ValidateInspector=function(){if(this.Name.length===0)return alert("Cannot add new inspector, missing Name."),!1;if(this.Intl.length===0)return alert("Cannot add new inspector, missing Initials."),!1;var t=this,i=n.inspectors_to_edit.filter(function(n){return n.Intl.toLowerCase()===t.Intl.toLowerCase()});return i.length>0?(alert("Cannot add new inspector, Initials must be unique."),!1):this.Color.length===0?(alert("Cannot add new inspector, missing Color.  You can use the color assigned to an inactive inspector."),!1):!0},t.CreateInputTableCell=function(n,t,i,r){var e,f,u;return r===void 0&&(r=null),e=document.createElement("td"),f=document.createElement("div"),f.classList.add("control"),u=document.createElement("input"),u.id=n+"_"+t,u.type="text",r!==null&&(u.maxLength=r),u.classList.add("input"),u.value=i,f.appendChild(u),e.appendChild(f),e},t.CreateCheckBoxTableCell=function(n,t,i){var f=document.createElement("td"),u=document.createElement("div"),r;return u.classList.add("control"),u.classList.add("has-text-centered"),r=document.createElement("input"),r.id=n+"_"+t,r.type="checkbox",r.classList.add("checkbox"),r.checked=i,u.appendChild(r),f.appendChild(u),f},t.UpdateCurrentCount=function(n,t){for(var f,r=[],e=function(n){n.CurrentCount=0;r=t.filter(function(t){return t.InspectorName===n.Name});n.CurrentCount=r.length},i=0,u=n;i<u.length;i++)f=u[i],e(f)},t.prototype.LoadFromForm=function(n,t){t===void 0&&(t=!1);this.Id=parseInt(n);this.Active=document.getElementById(n+"_active").checked;this.Name=Utilities.Get_Value(n+"_name").trim();this.Intl=t?Utilities.Get_Value(n+"_initial").trim():"";this.Color=t?Utilities.Get_Value(n+"_color").trim():"";this.Vehicle=Utilities.Get_Value(n+"_vehicle").trim();this.CBL=document.getElementById(n+"_c_b").checked;this.CEL=document.getElementById(n+"_c_e").checked;this.CPL=document.getElementById(n+"_c_p").checked;this.CME=document.getElementById(n+"_c_m").checked;this.RBL=document.getElementById(n+"_r_b").checked;this.REL=document.getElementById(n+"_r_e").checked;this.RPL=document.getElementById(n+"_r_p").checked;this.RME=document.getElementById(n+"_r_m").checked;this.Fire=document.getElementById(n+"_fire").checked;this.PrivateProvider=document.getElementById(n+"_private").checked},t.prototype.Update=function(t){var i=Utilities.Get_Path("/inspectionview");Utilities.Post(i+"API/Inspectors/Update/",this).then(function(i){if(i.length===0){alert("There was a problem saving your changes.  Please refresh the application and try again.  If this issue persists, please put in a help desk ticket.");return}Utilities.Set_Text("inspectorUpdateMessage","Changes have been made, please refresh this application to see them.");n.allInspectors=i;Utilities.Toggle_Loading_Button(t,!1)},function(n){console.log("error in Bulk Assign",n);Utilities.Toggle_Loading_Button(t,!1)})},t.prototype.Insert=function(n,i){var r=Utilities.Get_Path("/inspectionview");Utilities.Post(r+"API/Inspectors/Insert/",this).then(function(r){if(r===null){alert("There was a problem saving your changes.  Please refresh the application and try again.  If this issue persists, please put in a help desk ticket.");return}t.AddNewInspector(r);i.parentElement.removeChild(i);Utilities.Toggle_Loading_Button(n,!1);Utilities.Set_Text("inspectorUpdateMessage","Changes have been made, please refresh this application to see them.")},function(t){console.log("error in Bulk Assign",t);Utilities.Toggle_Loading_Button(n,!1)})},t.AddInspectorToEdit=function(){var r=document.getElementById("inspectorControlList"),i=t.GetNewInspectorId(),n=document.createElement("tr");n.appendChild(t.CreateInputTableCell(i,"name","",50));n.appendChild(t.CreateCheckBoxTableCell(i,"active",!1));n.appendChild(t.CreateInputTableCell(i,"initial","",3));n.appendChild(t.CreateInputTableCell(i,"color","",7));n.appendChild(t.CreateInputTableCell(i,"vehicle","",10));n.appendChild(t.CreateCheckBoxTableCell(i,"c_b",!1));n.appendChild(t.CreateCheckBoxTableCell(i,"c_e",!1));n.appendChild(t.CreateCheckBoxTableCell(i,"c_p",!1));n.appendChild(t.CreateCheckBoxTableCell(i,"c_m",!1));n.appendChild(t.CreateCheckBoxTableCell(i,"r_b",!1));n.appendChild(t.CreateCheckBoxTableCell(i,"r_e",!1));n.appendChild(t.CreateCheckBoxTableCell(i,"r_p",!1));n.appendChild(t.CreateCheckBoxTableCell(i,"r_m",!1));n.appendChild(t.CreateCheckBoxTableCell(i,"fire",!1));n.appendChild(t.CreateCheckBoxTableCell(i,"private",!1));n.appendChild(t.CreateAddButtonTableCell(i,n));r.appendChild(n)},t.GetNewInspectorId=function(){for(var n=1e4;n<11e3;n++)if(!document.getElementById(n.toString()+"_name"))return n.toString()},t}();n.Inspector=t}(IView||(IView={})),function(n){var t=function(){function t(){this.MasterPermitNumber="";this.PropUseInfo="";this.Age=-1;this.ValidInspectors=[];this.Sort_Order=0;this.myInspection=!1;this.IMSLink="";this.PermitTypeString="";this.MasterPermitIMSLink="";this.PreviousInspectionRemarks=""}return t.GetValidInspectors=function(t){return n.allInspectors.filter(function(n){return(t.RBL===n.RBL==!0||!t.RBL)&&(t.CBL===n.CBL==!0||!t.CBL)&&(t.REL===n.REL==!0||!t.REL)&&(t.CEL===n.CEL==!0||!t.CEL)&&(t.RME===n.RME==!0||!t.RME)&&(t.CME===n.CME==!0||!t.CME)&&(t.RPL===n.RPL==!0||!t.RPL)&&(t.CPL===n.CPL==!0||!t.CPL)&&(t.Fire===n.Fire==!0||!t.Fire)})},t.GetInspections=function(){Utilities.Toggle_Loading_Button("refreshButton",!0);Utilities.Toggle_Loading_Button("myRefreshButton",!0);Utilities.Toggle_Loading_Button("filterButton",!0);var i=Utilities.Get_Path("/inspectionview");Utilities.Get(i+"API/Inspections/GetInspections").then(function(n){var i=n.filter(function(n){return n.PreviousInspectionRemarks.length>0});console.log("inspections with previous remarks",i);t.HandleInspections(n);Utilities.Toggle_Loading_Button("refreshButton",!1);Utilities.Toggle_Loading_Button("myRefreshButton",!1);Utilities.Toggle_Loading_Button("filterButton",!1)},function(t){console.log("error getting inspectors",t);n.allInspectors=[];Utilities.Toggle_Loading_Button("refreshButton",!1);Utilities.Toggle_Loading_Button("myRefreshButton",!1);Utilities.Toggle_Loading_Button("filterButton",!1)})},t.GetPermitNotes=function(t,i,r){if(t.length!==0){Utilities.Toggle_Loading_Button(i,!0);var u=Utilities.Get_Path("/inspectionview");Utilities.Get(u+"API/Inspections/GetPermitNotes?PermitNo="+t).then(function(t){var f,e,o,u;if(t.length>0)for(f=0,e=t;f<e.length;f++)o=e[f],u=document.createElement("p"),u.classList.add("has-text-left"),u.appendChild(document.createTextNode(n.Strip_Html(o))),r.appendChild(u);else u=document.createElement("p"),u.classList.add("has-text-left"),u.appendChild(document.createTextNode("No notes found.")),r.appendChild(u);Utilities.Toggle_Loading_Button(i,!1)},function(n){console.log("error getting permit notes",n);Utilities.Toggle_Loading_Button(i,!1)})}},t.HandleInspections=function(i){for(var f,e,r=0,u=i;r<u.length;r++)f=u[r],f.ValidInspectors=t.GetValidInspectors(f);n.allInspections=i;n.Location.CreateLocations(n.ApplyFilters(i));n.current_location!==null&&(e=n.filteredLocations.filter(function(t){return t.lookup_key===n.current_location.lookup_key}),e.length===1&&(n.current_location=e[0],n.current_location.LocationView()));n.myInspections=i.filter(function(n){return n.myInspection&&n.ScheduledDay==="today"&&!n.IsCompleted});console.log("my inspections",n.myInspections);n.Location.HandleMyLocations(n.myInspections)},t.BulkAssign=function(n,i,r){var u,f,e;(r===void 0&&(r=undefined),i.length!==0)&&(r&&r.classList.add("is-loading"),u=document.getElementById("bulkAssignButton"),Utilities.Toggle_Loading_Button(u,!0),f=Utilities.Get_Path("/inspectionview"),e={InspectorId:n,InspectionIds:i},Utilities.Post(f+"API/Assign/BulkAssign/",e).then(function(n){if(Utilities.Toggle_Loading_Button(u,!1),n.length===0){alert("Server error in Bulk Assign.");return}t.HandleInspections(n);r&&r.classList.remove("is-loading")},function(n){console.log("error in Bulk Assign",n);Utilities.Toggle_Loading_Button(u,!1);r&&r.classList.remove("is-loading")}))},t}();n.Inspection=t}(IView||(IView={})),function(n){if(typeof exports=="object"&&typeof module!="undefined")module.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var t;t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this;t.dragula=n()}}(function(){return function n(t,i,r){function u(f,o){var h,c,s;if(!i[f]){if(!t[f]){if(h=typeof require=="function"&&require,!o&&h)return h(f,!0);if(e)return e(f,!0);c=new Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c;}s=i[f]={exports:{}};t[f][0].call(s.exports,function(n){var i=t[f][1][n];return u(i?i:n)},s,s.exports,n,t,i,r)}return i[f].exports}for(var e=typeof require=="function"&&require,f=0;f<r.length;f++)u(r[f]);return u}({1:[function(n,t){"use strict";function r(n){var t=i[n];return t?t.lastIndex=0:i[n]=t=new RegExp(u+n+f,"g"),t}function e(n,t){var i=n.className;i.length?r(t).test(i)||(n.className+=" "+t):n.className=t}function o(n,t){n.className=n.className.replace(r(t)," ").trim()}var i={},u="(?:^|\\s)",f="(?:\\s|$)";t.exports={add:e,rm:o}},{}],2:[function(n,t){(function(i){"use strict";function g(n,t){function ht(n){return a.containers.indexOf(n)!==-1||i.isContainer(n)}function gt(n){var t=n?"remove":"add";h(u,t,"mousedown",vi);h(u,t,"mouseup",at)}function ct(n){var t=n?"remove":"add";h(u,t,"mousemove",yi)}function ni(n){var t=n?"remove":"add";o[t](u,"selectstart",ti);o[t](u,"click",ti)}function ai(){gt(!0);at({})}function ti(n){ot&&n.preventDefault()}function vi(n){var r,t,i;(kt=n.clientX,dt=n.clientY,r=l(n)!==1||n.metaKey||n.ctrlKey,r)||(t=n.target,i=lt(t),i)&&(ot=i,ct(),n.type==="mousedown"&&(b(t)?t.focus():n.preventDefault()))}function yi(n){var r,t;if(ot){if(l(n)===0){at({});return}if(n.clientX===void 0||n.clientX!==kt||n.clientY===void 0||n.clientY!==dt){if(i.ignoreInputTextSelection){var u=e("clientX",n),o=e("clientY",n),h=s.elementFromPoint(u,o);if(b(h))return}r=ot;ct(!0);ni();ri();ii(r);t=nt(rt);wt=e("pageX",n)-t.left;bt=e("pageY",n)-t.top;f.add(g||rt,"gu-transit");gi();pt(n)}}}function lt(n){var t,u,f;if((!a.dragging||!it)&&!ht(n)){for(t=n;r(n)&&ht(r(n))===!1;){if(i.invalid(n,t))return;if(n=r(n),!n)return}if(u=r(n),u)return i.invalid(n,t)?void 0:(f=i.moves(n,u,t,c(n)),!f)?void 0:{item:n,source:u}}}function pi(n){return!!lt(n)}function wi(n){var t=lt(n);t&&ii(t)}function ii(n){tr(n.item,n.source)&&(g=n.item.cloneNode(!0),a.emit("cloned",g,n.item,"copy"));k=n.source;rt=n.item;et=ft=c(n.item);a.dragging=!0;a.emit("drag",rt,k)}function bi(){return!1}function ri(){if(a.dragging){var n=g||rt;fi(n,r(n))}}function ui(){ot=!1;ct(!0);ni(!0)}function at(n){if(ui(),a.dragging){var f=g||rt,r=e("clientX",n),u=e("clientY",n),o=v(it,r,u),t=si(o,r,u);t&&(g&&i.copySortSource||!g||t!==k)?fi(f,t):i.removeOnSpill?ei():oi()}}function fi(n,t){var u=r(n);g&&i.copySortSource&&t===k&&u.removeChild(rt);yt(t)?a.emit("cancel",n,k,k):a.emit("drop",n,t,k,ft);vt()}function ei(){if(a.dragging){var n=g||rt,t=r(n);t&&t.removeChild(n);a.emit(g?"cancel":"remove",n,t,k);vt()}}function oi(n){if(a.dragging){var f=arguments.length>0?n:i.revertOnSpill,t=g||rt,u=r(t),e=yt(u);e===!1&&f&&(g?u&&u.removeChild(g):k.insertBefore(t,et));e||f?a.emit("cancel",t,k,k):a.emit("drop",t,u,k,ft);vt()}}function vt(){var n=g||rt;ui();nr();n&&f.rm(n,"gu-transit");st&&clearTimeout(st);a.dragging=!1;ut&&a.emit("out",n,ut,k);a.emit("dragend",n);k=rt=g=et=ft=st=ut=null}function yt(n,t){var i;return i=t!==void 0?t:it?ft:c(g||rt),n===k&&i===et}function si(n,t,u){function e(){var e=ht(f);if(e===!1)return!1;var o=hi(f,n),r=ci(f,o,t,u),s=yt(f,r);return s?!0:i.accepts(rt,f,k,r)}for(var f=n;f&&!e();)f=r(f);return f}function pt(n){function w(n){a.emit(n,u,ut,k)}function nt(){l&&w("over")}function tt(){ut&&w("out")}var o,f,y;if(it){n.preventDefault();var s=e("clientX",n),h=e("clientY",n),b=s-wt,d=h-bt;it.style.left=b+"px";it.style.top=d+"px";var u=g||rt,p=v(it,s,h),t=si(p,s,h),l=t!==null&&t!==ut;if((l||t===null)&&(tt(),ut=t,nt()),o=r(u),t===k&&g&&!i.copySortSource){o&&o.removeChild(u);return}if(y=hi(t,p),y!==null)f=ci(t,y,s,h);else{if(i.revertOnSpill!==!0||g){g&&o&&o.removeChild(u);return}f=et;t=k}(f===null&&l||f!==u&&f!==c(u))&&(ft=f,t.insertBefore(u,f),a.emit("shadow",u,t,k))}}function ki(n){f.rm(n,"gu-hide")}function di(n){a.dragging&&f.add(n,"gu-hide")}function gi(){if(!it){var n=rt.getBoundingClientRect();it=rt.cloneNode(!0);it.style.width=p(n)+"px";it.style.height=w(n)+"px";f.rm(it,"gu-transit");f.add(it,"gu-mirror");i.mirrorContainer.appendChild(it);h(u,"add","mousemove",pt);f.add(i.mirrorContainer,"gu-unselectable");a.emit("cloned",it,rt,"mirror")}}function nr(){it&&(f.rm(i.mirrorContainer,"gu-unselectable"),h(u,"remove","mousemove",pt),r(it).removeChild(it),it=null)}function hi(n,t){for(var i=t;i!==n&&r(i)!==n;)i=r(i);return i===u?null:i}function ci(n,t,r,u){function o(){for(var o=n.children.length,e,t,i=0;i<o;i++)if((e=n.children[i],t=e.getBoundingClientRect(),f&&t.left+t.width/2>r)||!f&&t.top+t.height/2>u)return e;return null}function s(){var n=t.getBoundingClientRect();return f?e(r>n.left+p(n)/2):e(u>n.top+w(n)/2)}function e(n){return n?c(t):t}var f=i.direction==="horizontal";return t!==n?s():o()}function tr(n,t){return typeof i.copy=="boolean"?i.copy:i.copy(n,t)}var li=arguments.length,it,k,rt,wt,bt,kt,dt,et,ft,g,st,ut,ot,i,a;if(li===1&&Array.isArray(n)===!1&&(t=n,n=[]),ut=null,i=t||{},i.moves===void 0&&(i.moves=y),i.accepts===void 0&&(i.accepts=y),i.invalid===void 0&&(i.invalid=bi),i.containers===void 0&&(i.containers=n||[]),i.isContainer===void 0&&(i.isContainer=tt),i.copy===void 0&&(i.copy=!1),i.copySortSource===void 0&&(i.copySortSource=!1),i.revertOnSpill===void 0&&(i.revertOnSpill=!1),i.removeOnSpill===void 0&&(i.removeOnSpill=!1),i.direction===void 0&&(i.direction="vertical"),i.ignoreInputTextSelection===void 0&&(i.ignoreInputTextSelection=!0),i.mirrorContainer===void 0&&(i.mirrorContainer=s.body),a=d({containers:i.containers,start:wi,end:ri,cancel:oi,remove:ei,destroy:ai,canMove:pi,dragging:!1}),i.removeOnSpill===!0)a.on("over",ki).on("out",di);return gt(),a}function h(n,t,r,u){i.navigator.pointerEnabled?o[t](n,{mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"}[r],u):i.navigator.msPointerEnabled?o[t](n,{mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"}[r],u):(o[t](n,{mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"}[r],u),o[t](n,r,u))}function l(n){if(n.touches!==void 0)return n.touches.length;if(n.which!==void 0&&n.which!==0)return n.which;if(n.buttons!==void 0)return n.buttons;var t=n.button;if(t!==void 0)return t&1?1:t&2?3:t&4?2:0}function nt(n){var t=n.getBoundingClientRect();return{left:t.left+a("scrollLeft","pageXOffset"),top:t.top+a("scrollTop","pageYOffset")}}function a(n,t){return typeof i[t]!="undefined"?i[t]:u.clientHeight?u[n]:s.body[n]}function v(n,t,i){var r=n||{},f=r.className,u;return r.className+=" gu-hide",u=s.elementFromPoint(t,i),r.className=f,u}function tt(){return!1}function y(){return!0}function p(n){return n.width||n.right-n.left}function w(n){return n.height||n.bottom-n.top}function r(n){return n.parentNode===s?null:n.parentNode}function b(n){return n.tagName==="INPUT"||n.tagName==="TEXTAREA"||n.tagName==="SELECT"||k(n)}function k(n){return n?n.contentEditable==="false"?!1:n.contentEditable==="true"?!0:k(r(n)):!1}function c(n){function t(){var t=n;do t=t.nextSibling;while(t&&t.nodeType!==1);return t}return n.nextElementSibling||t()}function it(n){return n.targetTouches&&n.targetTouches.length?n.targetTouches[0]:n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n}function e(n,t){var i=it(t),r={pageX:"clientX",pageY:"clientY"};return n in r&&!(n in i)&&r[n]in i&&(n=r[n]),i[n]}var d=n("contra/emitter"),o=n("crossvent"),f=n("./classes"),s=document,u=s.documentElement;t.exports=g}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./classes":1,"contra/emitter":5,crossvent:6}],3:[function(n,t){t.exports=function(n,t){return Array.prototype.slice.call(n,t)}},{}],4:[function(n,t){"use strict";var i=n("ticky");t.exports=function(n,t,r){n&&i(function(){n.apply(r||null,t||[])})}},{ticky:9}],5:[function(n,t){"use strict";var i=n("atoa"),r=n("./debounce");t.exports=function(n,t){var f=t||{},u={};return n===undefined&&(n={}),n.on=function(t,i){return u[t]?u[t].push(i):u[t]=[i],n},n.once=function(t,i){i._once=!0;n.on(t,i);return n},n.off=function(t,i){var f=arguments.length,r;if(f===1)delete u[t];else if(f===0)u={};else{if(r=u[t],!r)return n;r.splice(r.indexOf(i),1)}return n},n.emit=function(){var t=i(arguments);return n.emitterSnapshot(t.shift()).apply(this,t)},n.emitterSnapshot=function(t){var e=(u[t]||[]).slice(0);return function(){var u=i(arguments),o=this||n;if(t==="error"&&f.throws!==!1&&!e.length)throw u.length===1?u[0]:u;return e.forEach(function(i){f.async?r(i,u,o):i.apply(o,u);i._once&&n.off(t,i)}),n}},n}},{"./debounce":4,atoa:3}],6:[function(n,t){(function(i){"use strict";function c(n,t,i,r){return n.addEventListener(t,i,r)}function l(n,t,i){return n.attachEvent("on"+t,w(n,t,i))}function a(n,t,i,r){return n.removeEventListener(t,i,r)}function v(n,t,i){var r=o(n,t,i);if(r)return n.detachEvent("on"+t,r)}function y(n,t,i){function f(){var n;return u.createEvent?(n=u.createEvent("Event"),n.initEvent(t,!0,!0)):u.createEventObject&&(n=u.createEventObject()),n}function e(){return new s(t,{detail:i})}var r=h.indexOf(t)===-1?e():f();n.dispatchEvent?n.dispatchEvent(r):n.fireEvent("on"+t,r)}function p(n,t,r){return function(t){var u=t||i.event;u.target=u.target||u.srcElement;u.preventDefault=u.preventDefault||function(){u.returnValue=!1};u.stopPropagation=u.stopPropagation||function(){u.cancelBubble=!0};u.which=u.which||u.keyCode;r.call(n,u)}}function w(n,t,i){var u=o(n,t,i)||p(n,t,i);return r.push({wrapper:u,element:n,type:t,fn:i}),u}function o(n,t,i){var u=b(n,t,i),f;if(u)return f=r[u].wrapper,r.splice(u,1),f}function b(n,t,i){for(var f,u=0;u<r.length;u++)if(f=r[u],f.element===n&&f.type===t&&f.fn===i)return u}var s=n("custom-event"),h=n("./eventmap"),u=i.document,f=c,e=a,r=[];i.addEventListener||(f=l,e=v);t.exports={add:f,remove:e,fabricate:y}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./eventmap":7,"custom-event":8}],7:[function(n,t){(function(n){"use strict";var r=[],i="";for(i in n)/^on/.test(i)&&r.push(i.slice(2));t.exports=r}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],8:[function(n,t){(function(n){function r(){try{var n=new i("cat",{detail:{foo:"bar"}});return"cat"===n.type&&"bar"===n.detail.foo}catch(t){}return!1}var i=n.CustomEvent;t.exports=r()?i:"function"==typeof document.createEvent?function(n,t){var i=document.createEvent("CustomEvent");return t?i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail):i.initCustomEvent(n,!1,!1,void 0),i}:function(n,t){var i=document.createEventObject();return i.type=n,t?(i.bubbles=Boolean(t.bubbles),i.cancelable=Boolean(t.cancelable),i.detail=t.detail):(i.bubbles=!1,i.cancelable=!1,i.detail=void 0),i}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],9:[function(n,t){var r=typeof setImmediate=="function",i;i=r?function(n){setImmediate(n)}:function(n){setTimeout(n,0)};t.exports=i},{}]},{},[2])(2)});autoScroll=function(){"use strict";function b(n,t){return typeof n=="undefined"?typeof t=="undefined"?n:t:n}function f(n,t){return(n=b(n,t),typeof n=="function")?function(){for(var u=arguments,i=arguments.length,r=Array(i),t=0;t<i;t++)r[t]=u[t];return!!n.apply(this,r)}:!n?function(){return!1}:function(){return!0}}function a(n,t){if(t=i(t,!0),!l(t))return-1;for(var r=0;r<n.length;r++)if(n[r]===t)return r;return-1}function o(n,t){return-1!==a(n,t)}function tt(n,t){for(var i=0;i<t.length;i++)o(n,t[i])||n.push(t[i]);return t}function it(n){for(var u=arguments,t=[],r=arguments.length-1;r-->0;)t[r]=u[r+1];return t=t.map(i),tt(n,t)}function rt(n){for(var u=arguments,r=[],t=arguments.length-1;t-->0;)r[t]=u[t+1];return r.map(i).reduce(function(t,i){var r=a(n,i);return r!==-1?t.concat(n.splice(r,1)):t},[])}function i(n,t){if(typeof n=="string")try{return document.querySelector(n)}catch(i){throw i;}if(!l(n)&&!t)throw new TypeError(n+" is not a DOM element.");return n}function ut(n,t){t=t||{};var i=f(t.allowUpdate,!0);return function(t){if(t=t||window.event,n.target=t.target||t.srcElement||t.originalTarget,n.element=this,n.type=t.type,i(t)){if(t.targetTouches)n.x=t.targetTouches[0].clientX,n.y=t.targetTouches[0].clientY,n.pageX=t.targetTouches[0].pageX,n.pageY=t.targetTouches[0].pageY,n.screenX=t.targetTouches[0].screenX,n.screenY=t.targetTouches[0].screenY;else{if(t.pageX===null&&t.clientX!==null){var f=t.target&&t.target.ownerDocument||document,r=f.documentElement,u=f.body;n.pageX=t.clientX+(r&&r.scrollLeft||u&&u.scrollLeft||0)-(r&&r.clientLeft||u&&u.clientLeft||0);n.pageY=t.clientY+(r&&r.scrollTop||u&&u.scrollTop||0)-(r&&r.clientTop||u&&u.clientTop||0)}else n.pageX=t.pageX,n.pageY=t.pageY;n.x=t.clientX;n.y=t.clientY;n.screenX=t.screenX;n.screenY=t.screenY}n.clientX=n.x;n.clientY=n.y}}}function ft(){var t={top:{value:0,enumerable:!0},left:{value:0,enumerable:!0},right:{value:window.innerWidth,enumerable:!0},bottom:{value:window.innerHeight,enumerable:!0},width:{value:window.innerWidth,enumerable:!0},height:{value:window.innerHeight,enumerable:!0},x:{value:0,enumerable:!0},y:{value:0,enumerable:!0}},n;return Object.create?Object.create({},t):(n={},Object.defineProperties(n,t),n)}function v(n){if(n===window)return ft();try{var t=n.getBoundingClientRect();return t.x===undefined&&(t.x=t.left,t.y=t.top),t}catch(i){throw new TypeError("Can't call getBoundingClientRect on "+n);}}function et(n,t){var i=v(t);return n.y>i.top&&n.y<i.bottom&&n.x>i.left&&n.x<i.right}function ot(t){function r(t){for(var r=0;r<n.length;r++)i[n[r]]=t[n[r]]}function f(){t&&t.removeEventListener("mousemove",r,!1);i=null}var i={screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1,button:0,buttons:1,relatedTarget:null,region:null},u;return t!==undefined&&t.addEventListener("mousemove",r),u=function(){return MouseEvent?function(n,t,r){var u=new MouseEvent("mousemove",s(i,t));return h(u,r),n.dispatchEvent(u)}:typeof document.createEvent=="function"?function(n,t,r){var u=s(i,t),f=document.createEvent("MouseEvents");return f.initMouseEvent("mousemove",!0,!0,window,0,u.screenX,u.screenY,u.clientX,u.clientY,u.ctrlKey,u.altKey,u.shiftKey,u.metaKey,u.button,u.relatedTarget),h(f,r),n.dispatchEvent(f)}:typeof document.createEventObject=="function"?function(n,t,r){var u=document.createEventObject(),f=s(i,t);for(var e in f)u[e]=f[e];return h(u,r),n.dispatchEvent(u)}:void 0}(),{destroy:f,dispatch:u}}function s(t,i){var u,r;for(i=i||{},u=p(t),r=0;r<n.length;r++)i[n[r]]!==undefined&&(u[n[r]]=i[n[r]]);return u}function h(n,t){console.log("data ",t);n.data=t||{};n.dispatched="mousemove"}function st(n,i){function nt(t){for(var i=0;i<n.length;i++)if(n[i]===t.target){a=!0;break}a&&u(function(){return a=!1})}function k(){p=!0}function h(){p=!1;tt()}function tt(){t(l);t(c)}function ft(){p=!1}function vt(t){if(!t)return null;if(s===t||o(n,t))return t;while(t=t.parentNode)if(o(n,t))return t;return null}function et(){for(var i=null,t=0;t<n.length;t++)w(e,n[t])&&(i=n[t]);return i}function d(n){if(r.autoScroll()&&!n.dispatched){var i=n.target,f=document.body;(s&&!w(e,s)&&(r.scrollWhenOutside||(s=null)),i&&i.parentNode===f?i=et():(i=vt(i),i||(i=et())),i&&i!==s&&(s=i),b&&(t(c),c=u(st)),s)&&(t(l),l=u(ht))}}function st(){ct(b);t(c);c=u(st)}function ht(){s&&(ct(s),t(l),l=u(ht))}function ct(n){var t=v(n),i,u;i=e.x<t.left+r.margin?Math.floor(Math.max(-1,(e.x-t.left)/r.margin-1)*r.maxSpeed):e.x>t.right-r.margin?Math.ceil(Math.min(1,(e.x-t.right)/r.margin+1)*r.maxSpeed):0;u=e.y<t.top+r.margin?Math.floor(Math.max(-1,(e.y-t.top)/r.margin-1)*r.maxSpeed):e.y>t.bottom-r.margin?Math.ceil(Math.min(1,(e.y-t.bottom)/r.margin+1)*r.maxSpeed):0;r.syncMove()&&lt.dispatch(n,{pageX:e.pageX+i,pageY:e.pageY+u,clientX:e.x+i,clientY:e.y+u});setTimeout(function(){u&&yt(n,u);i&&pt(n,i)})}function yt(n,t){n===window?window.scrollTo(n.pageXOffset,n.pageYOffset+t):n.scrollTop+=t}function pt(n,t){n===window?window.scrollTo(n.pageXOffset+t,n.pageYOffset):n.scrollLeft+=t}var b,c,at,s,l;i===void 0&&(i={});var r=this,g=4,a=!1;this.margin=i.margin||-1;this.scrollWhenOutside=i.scrollWhenOutside||!1;var e={},y=ut(e),lt=ot(),p=!1;window.addEventListener("mousemove",y,!1);window.addEventListener("touchmove",y,!1);isNaN(i.maxSpeed)||(g=i.maxSpeed);this.autoScroll=f(i.autoScroll);this.syncMove=f(i.syncMove,!1);this.destroy=function(t){window.removeEventListener("mousemove",y,!1);window.removeEventListener("touchmove",y,!1);window.removeEventListener("mousedown",k,!1);window.removeEventListener("touchstart",k,!1);window.removeEventListener("mouseup",h,!1);window.removeEventListener("touchend",h,!1);window.removeEventListener("pointerup",h,!1);window.removeEventListener("mouseleave",ft,!1);window.removeEventListener("mousemove",d,!1);window.removeEventListener("touchmove",d,!1);window.removeEventListener("scroll",nt,!0);n=[];t&&tt()};this.add=function(){for(var i=[],t=arguments.length;t--;)i[t]=arguments[t];return it.apply(void 0,[n].concat(i)),this};this.remove=function(){for(var i=[],t=arguments.length;t--;)i[t]=arguments[t];return rt.apply(void 0,[n].concat(i))};b=null;Object.prototype.toString.call(n)!=="[object Array]"&&(n=[n]),function(t){n=[];t.forEach(function(n){n===window?b=window:r.add(n)})}(n);Object.defineProperties(this,{down:{get:function(){return p}},maxSpeed:{get:function(){return g}},point:{get:function(){return e}},scrolling:{get:function(){return a}}});at=0;s=null;window.addEventListener("mousedown",k,!1);window.addEventListener("touchstart",k,!1);window.addEventListener("mouseup",h,!1);window.addEventListener("touchend",h,!1);window.addEventListener("pointerup",h,!1);window.addEventListener("mousemove",d,!1);window.addEventListener("touchmove",d,!1);window.addEventListener("mouseleave",ft,!1);window.addEventListener("scroll",nt,!0)}function ht(n,t){return new st(n,t)}function w(n,t,i){return i?n.y>i.top&&n.y<i.bottom&&n.x>i.left&&n.x<i.right:et(n,t)}var r=["webkit","moz","ms","o"],u=function(){for(var n=0,t=r.length;n<t&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[r[n]+"RequestAnimationFrame"];return window.requestAnimationFrame||function(){var n=0;window.requestAnimationFrame=function(t){var i=(new Date).getTime(),r=Math.max(0,16-i-n),u=window.setTimeout(function(){return t(i+r)},r);return n=i+r,u}}(),window.requestAnimationFrame.bind(window)}(),t=function(){for(var n=0,t=r.length;n<t&&!window.cancelAnimationFrame;++n)window.cancelAnimationFrame=window[r[n]+"CancelAnimationFrame"]||window[r[n]+"CancelRequestAnimationFrame"];return window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){window.clearTimeout(n)}),window.cancelAnimationFrame.bind(window)}(),k=function(){var n=function(n){return typeof n=="function"},t=function(n){var t=Number(n);return isNaN(t)?0:t===0||!isFinite(t)?t:(t>0?1:-1)*Math.floor(Math.abs(t))},i=Math.pow(2,53)-1,r=function(n){var r=t(n);return Math.min(Math.max(r,0),i)},u=function(n){if(n!=null){if(["string","number","boolean","symbol"].indexOf(typeof n)>-1||typeof Symbol!="undefined"&&"iterator"in Symbol&&Symbol.iterator in n)return Symbol.iterator;if("@@iterator"in n)return"@@iterator"}},f=function(t,i){if(t!=null&&i!=null){var r=t[i];if(r==null)return void 0;if(!n(r))throw new TypeError(r+" is not a function");return r}},e=function(n){var t=n.next(),i=Boolean(t.done);return i?!1:t};return function(t){var c=this,s=arguments.length>1?arguments[1]:void 0,l,o,i,a,v,y,p,w,h,b;if(typeof s!="undefined"){if(!n(s))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(l=arguments[2])}if(a=f(t,u(t)),a!==void 0){if(o=n(c)?Object(new c):[],v=a.call(t),v==null)throw new TypeError("Array.from requires an array-like or iterable object");for(i=0;;){if(y=e(v),!y)return o.length=i,o;p=y.value;o[i]=s?s.call(l,p,i):p;i++}}else{if(w=Object(t),t==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");for(h=r(w.length),o=n(c)?Object(new c(h)):new Array(h),i=0;i<h;)b=w[i],o[i]=s?s.call(l,b,i):b,i++;o.length=h}return o}}(),c=typeof Array.from=="function"?Array.from:k,d=Array.isArray,g=Object.prototype.toString,nt=d||function(n){return!!n&&"[object Array]"==g.call(n)},e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol?"symbol":typeof n},l=function(n){return n!=null&&(typeof n=="undefined"?"undefined":e(n))==="object"&&n.nodeType===1&&e(n.style)==="object"&&e(n.ownerDocument)==="object"},y=void 0,p,n;return y=typeof Object.create!="function"?function(n){var t=function(){};return function(i,r){if(i!==Object(i)&&i!==null)throw TypeError("Argument must be an object, or null");t.prototype=i||{};var u=new t;return t.prototype=null,r!==n&&Object.defineProperties(u,r),i===null&&(u.__proto__=null),u}}():Object.create,p=y,n=["altKey","button","buttons","clientX","clientY","ctrlKey","metaKey","movementX","movementY","offsetX","offsetY","pageX","pageY","region","relatedTarget","screenX","screenY","shiftKey","which","x","y"],ht}(),function(n){function l(){n.mapController=new n.MapController("map");n.Inspector.GetAllInspectors();a()}function a(){var t=document.getElementById("sortableInspections"),i=dragula([t],{direction:"vertical",copy:!1,revertOnSplit:!0,ignoreInputTextSelection:!1}),r=autoScroll([t],{margin:20,maxSpeed:30,scrollWhenOutside:!0,autoScroll:function(){return this.down&&i.dragging}});i.on("drop",function(t,i){for(var e,f,u,r=0;r<i.children.length;r++)e=i.children[r],f=n.Location.GetLocationIndex(e.id,n.myLocations),f!==-1&&(u=n.myLocations[f],u.order=r+1,t.id===u.lookup_key&&u.unordered&&(u.unordered=!1));n.Location.UpdateMyLocations()})}function v(){var i=document.getElementById("sortableInspections"),t;i.childElementCount<1||(t=i.firstElementChild,t!==null)&&(n.myLocations=n.Location.SortByProximity(n.myLocations,t.id),n.Location.UpdateMyLocations())}function y(){var i=document.getElementById("sortableInspections"),t;i.childElementCount<1||(t=i.lastElementChild,t!==null)&&(n.myLocations=n.Location.SortByProximity(n.myLocations,t.id),n.Location.UpdateMyLocations())}function p(t){var i=document.getElementById("myInspections");i.classList.contains("column")?(i.classList.remove("column"),t.classList.remove("is-inverted"),t.classList.remove("is-outline"),t.classList.remove("is-white"),Utilities.Hide(i),n.mapController.ToggleMyLocations(!1)):(i.classList.add("column"),t.classList.add("is-white"),t.classList.add("is-inverted"),t.classList.add("is-outline"),Utilities.Show(i),n.mapController.ToggleMyLocations(!0))}function w(){var f=t("inspection_status_filter"),s=t("day_filter"),h=t("permit_kind_filter"),c=t("private_provider_only"),l=t("invalid_address_only"),a=t("permit_type_filter"),v=t("inspector_filter"),y=t("show_bulk_assign"),i,e,p,u,o,w;if(f!==null){for(f!==null&&(n.inspection_status_filter=f),s!==null&&(n.day_filter=s),h!==null&&(n.permit_kind_filter=h),c!==null&&(n.private_provider_only=c.toLowerCase()==="true"),l!==null&&(n.invalid_address_only=l.toLowerCase()==="true"),a!==null&&(n.permit_type_filter=a.split(",")),v!==null&&(n.inspector_filter=v.split(",")),y!==null&&(n.show_bulk_assign=y.toLowerCase()==="true"),n.show_bulk_assign?Utilities.Show("BulkAssignContainer"):Utilities.Hide("BulkAssignContainer"),document.querySelector("input[name='inspectionStatus'][value='"+n.inspection_status_filter+"']").checked=!0,document.querySelector("input[name='inspectionDay'][value='"+n.day_filter+"']").checked=!0,document.querySelector("input[name='commercialResidential'][value='"+n.permit_kind_filter+"']").checked=!0,document.getElementById("privateProviderFilter").checked=n.private_provider_only,document.getElementById("invalidAddressFilter").checked=n.invalid_address_only,r("input[name='inspectorFilter']",!1),i=0,e=n.inspector_filter;i<e.length;i++)p=e[i],document.querySelector("input[name='inspectorFilter'][value='"+p+"']").checked=!0;for(r("input[name='permitType']",!1),u=0,o=n.permit_type_filter;u<o.length;u++)w=o[u],document.querySelector("input[name='permitType'][value='"+w+"']").checked=!0}}function b(){o();i("inspection_status_filter",n.inspection_status_filter);i("day_filter",n.day_filter);i("permit_kind_filter",n.permit_kind_filter);i("private_provider_only",n.private_provider_only.toString());i("invalid_address_only",n.invalid_address_only.toString());i("permit_type_filter",n.permit_type_filter.join(","));i("inspector_filter",n.inspector_filter.join(","));i("show_bulk_assign",n.show_bulk_assign.toString())}function t(n){var i="; "+document.cookie,t=i.split("; inspectionview_"+n+"=");return t.length==2?t.pop().split(";").shift():null}function i(n,t){var u=(new Date).getFullYear()+1,i=new Date,r;i.setFullYear(u);r="inspectionview_"+n+"="+t+"; expires="+i.toUTCString()+"; path="+Utilities.Get_Path("/inspectionview");document.cookie=r}function k(){n.day_filter="today";n.inspection_status_filter="open";n.permit_kind_filter="all";n.permit_type_filter=[];n.inspector_filter=[];n.private_provider_only=!1;n.invalid_address_only=!1;document.querySelector("input[name='inspectionStatus'][value='open']").checked=!0;document.querySelector("input[name='inspectionDay'][value='today']").checked=!0;document.querySelector("input[name='commercialResidential'][value='all']").checked=!0;document.getElementById("privateProviderFilter").checked=!1;document.getElementById("invalidAddressFilter").checked=!1;r("input[name='inspectorFilter']",!1);document.querySelector("input[name='inspectorFilter'][value='All']").checked=!0;r("input[name='permitType']",!1);document.querySelector("input[name='permitType'][value='all']").checked=!0;n.Location.CreateLocations(u(n.allInspections))}function d(t){t==="inspectors"?(n.inspector_toggle_status=!n.inspector_toggle_status,r("input[name='inspectorFilter']",n.inspector_toggle_status)):(n.permit_types_toggle_status=!n.permit_types_toggle_status,r("input[name='permitType']",n.permit_types_toggle_status));n.Location.CreateLocations(u(n.allInspections))}function g(){n.show_bulk_assign=!n.show_bulk_assign;n.show_bulk_assign?Utilities.Show("BulkAssignContainer"):Utilities.Hide("BulkAssignContainer")}function r(n,t){for(var r=document.querySelectorAll(n),i=0;i<r.length;i++)r.item(i).checked=t}function nt(){for(var i=document.querySelectorAll("#filters input"),t=0;t<i.length;t++)i.item(t).addEventListener("click",function(){n.Location.CreateLocations(u(n.allInspections))})}function o(){n.inspection_status_filter=f('input[name="inspectionStatus"]:checked');n.day_filter=f('input[name="inspectionDay"]:checked');n.permit_kind_filter=f('input[name="commercialResidential"]:checked');n.private_provider_only=document.getElementById("privateProviderFilter").checked;n.invalid_address_only=document.getElementById("invalidAddressFilter").checked;n.permit_type_filter=s('input[name="permitType"]:checked');n.inspector_filter=s('input[name="inspectorFilter"]:checked')}function u(t){var i,r,u;return o(),i=t,n.inspection_status_filter!=="all"&&(r=n.inspection_status_filter!=="open",i=n.allInspections.filter(function(n){return n.IsCompleted===r})),n.day_filter!=="all"&&(i=n.day_filter!=="prior"?i.filter(function(t){return t.ScheduledDay===n.day_filter}):i.filter(function(n){return n.Age>0})),n.permit_kind_filter!=="all"&&(u=n.permit_kind_filter==="commercial",i=i.filter(function(n){return n.IsCommercial===u})),n.permit_type_filter.indexOf("all")===-1&&(i=i.filter(function(t){return n.permit_type_filter.indexOf(t.PermitNo.substr(0,1))!==-1})),n.private_provider_only&&(i=i.filter(function(n){return n.IsPrivateProvider})),n.invalid_address_only&&(i=i.filter(function(n){return!n.AddressPoint.IsValid||!n.ParcelPoint.IsValid})),n.inspector_filter.indexOf("All")===-1&&(i=i.filter(function(t){return n.inspector_filter.indexOf(t.InspectorName)!==-1})),n.Inspector.UpdateCurrentCount(n.allInspectors,i),tt(n.allInspectors.filter(function(n){return n.CurrentCount>0})),i}function tt(n){var o=document.getElementById("InspectorList"),r,e,i,t,u,f;for(Utilities.Clear_Element(o),r=0,e=n;r<e.length;r++)i=e[r],t=document.createElement("li"),t.style.color=i.Id===0?"black":"white",t.style.paddingLeft="1em",t.style.paddingRight="1em",t.style.backgroundColor=i.Color,t.style.display="flex",t.style.justifyContent="space-between",u=document.createElement("span"),u.appendChild(document.createTextNode(i.Name)),u.style.textAlign="left",f=document.createElement("span"),f.appendChild(document.createTextNode(i.CurrentCount.toString())),f.style.textAlign="right",t.appendChild(u),t.appendChild(f),o.appendChild(t)}function f(n){return document.querySelector(n).value}function s(n){for(var i=document.querySelectorAll(n),r=[],t=0;t<i.length;t++)r.push(i.item(t).value);return r}function e(){var u=location.hash,i=new n.LocationHash(location.hash.substring(1)),t,r;i.InspectionId>0&&(t=n.allInspections.filter(function(n){return n.InspReqID===i.InspectionId}),t.length>0&&(console.log("inspection based on passed id",t,"inspection point to use",t[0].PointToUse),n.mapController.CenterAndZoom(t[0].PointToUse),r=n.allInspections.filter(function(n){return n.PointToUse.Latitude===t[0].PointToUse.Latitude}),console.log("all points",r)))}function it(){n.mapLoaded=!0;console.log("map load completed");h()}function h(){n.mapLoaded&&n.dataLoaded&&(window.onhashchange=e,e(),n.mapController.UpdateLocationLayer(n.filteredLocations),n.Unit.GetUnits())}function rt(){var r=document.getElementById("bulkAssignSelect"),t=document.getElementById("bulkAssignButton"),i;if(Utilities.Toggle_Loading_Button(t,!0),i=Utilities.Get_Value(r),i==="-1"){Utilities.Error_Show("bulkAssignError","Please choose an inspector.",!0);Utilities.Toggle_Loading_Button(t,!1);return}Utilities.Show("cancelBulkAssign");n.mapController.ToggleDraw(!0)}function ut(){n.mapController.ToggleDraw(!1);Utilities.Toggle_Loading_Button("bulkAssignButton",!1);Utilities.Hide("cancelBulkAssign")}function ft(){document.getElementById("filters").classList.add("is-active")}function et(){document.getElementById("inspectorEdit").classList.add("is-active")}function ot(){if(n.current_location=null,!1){var t=n.last_selected_graphic.symbol,i=n.last_symbol_color;window.setTimeout(function(){t.color=i;n.location_layer.redraw()},1e4)}c()}function c(){var t=document.querySelectorAll(".modal"),n,i;if(t.length>0)for(n=0;n<t.length;n++)i=t.item(n),i.classList.remove("is-active")}function st(t){var i,r,u,f,e;n.current_location!==null&&(i=Utilities.Get_Value(t.srcElement),i.length!==0)&&(r=n.allInspectors.filter(function(n){return n.Name===i}),u=t.srcElement.parentElement,r.length===1&&(f=r[0].Id,e=n.current_location.inspections.map(function(n){return n.InspReqID}),n.Inspection.BulkAssign(f,e,u)))}function ht(n){var t=(new DOMParser).parseFromString(n,"text/html");return t.body.textContent||""}function ct(t){var i=n.mapController.FindItemsInExtent(t),r=parseInt(document.getElementById("bulkAssignSelect").value);lt(r,i);Utilities.Toggle_Loading_Button(document.getElementById("bulkAssignButton"),!1);Utilities.Hide("cancelBulkAssign")}function lt(t,i){for(var u,f=[],r=0,e=n.allInspections;r<e.length;r++)u=e[r],i.indexOf(u.LookupKey)!==-1&&f.push(u.InspReqID);n.Inspection.BulkAssign(t,f)}n.allInspections=[];n.myLocations=[];n.myInspections=[];n.inspectors_to_edit=[];n.allInspectors=[];n.allUnits=[];n.filteredLocations=[];n.current_location=null;n.day_filter="today";n.inspection_status_filter="open";n.permit_kind_filter="all";n.permit_type_filter=[];n.inspector_filter=[];n.private_provider_only=!1;n.invalid_address_only=!1;n.show_bulk_assign=!0;n.contractor_check=!0;n.permit_types_toggle_status=!1;n.inspector_toggle_status=!1;n.mapLoaded=!1;n.dataLoaded=!1;n.Start=l;n.ReorderLocations=v;n.ReverseOrderLocations=y;n.ToggleMyInspections=p;n.LoadDefaultsFromCookie=w;n.SaveCookie=b;n.ResetFilters=k;n.Toggle_Group=d;n.Toggle_Bulk_Assign=g;n.FilterInputEvents=nt;n.ApplyFilters=u;n.HandleHash=e;n.mapLoadCompleted=it;n.BuildAndLoadInitialLayers=h;n.DrawToggle=rt;n.CancelDrawToggle=ut;n.ShowFilters=ft;n.ShowInspectors=et;n.CloseLocationModal=ot;n.CloseModals=c;n.Bulk_Assign_Location=st;n.Strip_Html=ht;n.FindItemsInExtent=ct}(IView||(IView={}));